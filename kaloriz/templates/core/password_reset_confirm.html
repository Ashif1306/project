{% extends 'base.html' %}

{% block title %}Buat Password Baru - Kaloriz{% endblock %}
{% block body_class %}no-navbar-offset{% endblock %}
{% block extra_head %}
<style>
  .auth-page {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #38b6ff 0%, #2196F3 100%);
    padding: 20px;
  }
  .auth-card {
    background: white;
    border-radius: 30px;
    box-shadow: 0 25px 60px rgba(0, 0, 0, 0.15);
    max-width: 700px;
    width: 100%;
    padding: 60px;
  }
  .auth-title {
    font-size: 42px;
    font-weight: 700;
    margin-bottom: 20px;
  }
  .auth-description {
    color: #555;
    line-height: 1.6;
    margin-bottom: 30px;
  }
  .auth-field { margin-bottom: 25px; }
  .auth-label { display: block; margin-bottom: 10px; color: #666; font-weight: 600; }
  .auth-input {
    width: 100%; padding: 16px 18px; border: 1px solid #e0e0e0; border-radius: 10px; background: #f8f9fa;
  }
  .auth-input:focus { outline: none; border-color: #38b6ff; background: #fff; box-shadow: 0 0 0 4px rgba(56,182,255,0.15); }
  .auth-submit { width: 100%; padding: 18px; background: #38b6ff; color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; }
  .auth-message { padding: 12px 16px; border-radius: 10px; margin-top: 10px; font-size: 14px; }
  .auth-message--error { background: #fee; color: #c62828; border: 1px solid #fbb; }
  .auth-meta { margin-top: 30px; text-align: center; }
  .auth-meta a { color: #38b6ff; font-weight: 600; }
</style>
{% endblock %}
{% block navbar %}{% endblock %}

{% block content %}
<div class="auth-page">
  <div class="auth-card">
    {% if validlink %}
      <h1 class="auth-title">Buat password baru</h1>
      <p class="auth-description">Password baru harus berbeda dari password sebelumnya agar akunmu lebih aman.</p>
      <form method="post" class="auth-form">
        {% csrf_token %}
        {% if form.non_field_errors %}
          <div class="auth-message auth-message--error">{{ form.non_field_errors|join:' ' }}</div>
        {% endif %}
        <div class="auth-field">
          <label for="id_new_password1" class="auth-label">Password baru</label>
          <input type="password" name="new_password1" id="id_new_password1" class="auth-input" required>
          {% if form.new_password1.errors %}
            <div class="auth-message auth-message--error">{{ form.new_password1.errors|join:' ' }}</div>
          {% endif %}
        </div>
        <div class="auth-field">
          <label for="id_new_password2" class="auth-label">Konfirmasi password</label>
          <input type="password" name="new_password2" id="id_new_password2" class="auth-input" required>
          {% if form.new_password2.errors %}
            <div class="auth-message auth-message--error">{{ form.new_password2.errors|join:' ' }}</div>
          {% endif %}
        </div>
        <button type="submit" class="auth-submit">Simpan password baru</button>
      </form>
    {% else %}
      <h1 class="auth-title">Tautan tidak valid</h1>
      <p class="auth-description">Tautan reset password ini sudah digunakan atau kedaluwarsa. Silakan buat permintaan baru.</p>
      <p class="auth-meta"><a href="{% url 'core:password_reset' %}">Kembali ke halaman reset</a></p>
    {% endif %}
  </div>
</div>
{% endblock %}
